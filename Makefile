###############################################################################
# Makefile
###############################################################################

DIA = $(wildcard *.dia)
EPS = $(DIA:.dia=.eps)
PNG = $(DIA:.dia=.png)
TEX = $(wildcard *.tex)
BBL = $(TEX:.tex=.bbl)
PDF = $(TEX:.tex=.pdf)

###############################################################################

all: $(EPS) $(PNG) $(PDF)

auto: $(EPS) $(PNG)
	latexmk -pdf -pvc

clean:
	latexmk -C
	$(RM) $(BBL) *-eps-converted-to.pdf *~

###############################################################################

%.eps: %.dia
	dia -e $@ $<

%.png: %.dia
	dia -e $@ $<

%.pdf: $(EPS) $(PNG) %.tex
	latexmk -f -pdf $*

###############################################################################

.NOEXPORT:

###############################################################################

