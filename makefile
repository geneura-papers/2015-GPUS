###############################################################################
# makefile
###############################################################################

DIA = $(wildcard *.dia)
PNG = $(DIA:.dia=.png)
TEX = $(wildcard *.tex)
TMP = $(TEX:.tex=.aux) $(TEX:.tex=.bbl) $(TEX:.tex=.blg) $(TEX:.tex=.fdb_latexmk) $(TEX:.tex=.fls) $(TEX:.tex=.log) $(TEX:.tex=.out) $(TEX:.tex=.spl)
PDF = $(TEX:.tex=.pdf)

###############################################################################

all: $(PNG) $(PDF)

auto: $(PNG)
	latexmk -pdf -pvc

clean:
	-latexmk -C
	-$(RM) -fv $(TMP) *-eps-converted-to.pdf *~

###############################################################################

%.png: %.dia
	dia -e $@ $<

%.pdf: $(DIA) $(PNG) %.bib %.tex
	latexmk -f -pdf $*

###############################################################################

.NOEXPORT:

###############################################################################

